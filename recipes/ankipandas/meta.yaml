{% set version = "0.3.10" %}

package:
  name: ankipandas
  version: {{ version }}

source:
  - url: https://pypi.io/packages/source/a/ankipandas/ankipandas-{{ version }}.tar.gz
    sha256: af95a33a163f85ab33ff48ef75a7b2d24559bb9108df52fe9275edf062d80864
  - url: https://raw.githubusercontent.com/klieret/AnkiPandas/v{{ version }}/ankipandas/version.txt
    sha256: a7630cf27d7d338f77cd356decbbb9a8012caad51612c6c1ec981d1606ac2f46
  - url: https://raw.githubusercontent.com/klieret/AnkiPandas/v{{ version }}/requirements.txt
    sha256: eec71fb281b68a80814b46fb2b508952b431dc74de6fdf332e988ce485ec2f59

build:
  number: 0
  noarch: python
  script:
    # TODO: remove after 0.3.11
    - {{ PYTHON }} -c '__import__("pathlib").Path("version.txt").rename("ankipandas/version.txt")'
    - {{ PYTHON }} -m pip install . -vv

requirements:
  host:
    - pip
    - python >=3.6
  run:
    - colorlog
    - numpy
    - pandas
    - python >=3.6
    - randomfiletree

test:
  imports:
    - ankipandas
  commands:
    - pip check
    # TODO: restore for 0.3.11, determine coverage threshold
    # - pytest --pyargs ankipandas --cov ankipandas --cov-report term-missing:skip-covered --no-cov-on-fail --cov-fail-under 100
  requires:
    - pip
    - pytest-cov

about:
  home: https://github.com/klieret/ankipandas
  summary: Load your anki database as a pandas DataFrame with just one line of code!
  license: MIT
  license_file: LICENSE.txt

extra:
  recipe-maintainers:
    - bollwyvl
